function addTag(a,b,c){var d,e=document.createElement(a);for(d in b)e.setAttribute(d,b[d]);c?document.write(outerHTML(e)):headEl.appendChild(e)}function outerHTML(a){return a.outerHTML||function(a){var b,c=document.createElement("div");return c.appendChild(a),b=c.innerHTML,c=null,b}(a)}function serializeFormPostData(){function a(a,c){var d=c();return d["Content-type"]="application/x-www-form-urlencoded; charset=utf-8",b(a)}function b(a){if(!angular.isObject(a))return null==a?"":a.toString();var b=[];for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];b.push(encodeURIComponent(c)+"="+encodeURIComponent(null==d?"":d))}var e=b.join("&").replace(/%20/g,"+");return e}return a}var yamba={App:null,appname:"yamba"};Array.prototype.merge=function(a){if(!angular.isArray(a))return this;for(var b=this||[],c=0;c<a.length;c++)b.push(a[c]);return b},Number.prototype.num_format=function(a,b,c){number=(this+"").replace(/[^0-9+\-Ee.]/g,"");var d=isFinite(+number)?+number:0,e=isFinite(+a)?Math.abs(a):0,f="undefined"==typeof c?",":c,g="undefined"==typeof b?".":b,h="",i=function(a,b){var c=Math.pow(10,b);return""+(Math.round(a*c)/c).toFixed(b)};return h=(e?i(d,e):""+Math.round(d)).split("."),h[0].length>3&&(h[0]=h[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,f)),(h[1]||"").length<e&&(h[1]=h[1]||"",h[1]+=new Array(e-h[1].length+1).join("0")),h.join(g)},Array.prototype.getIndexByKeyVal=function(a,b){for(var c=this,d=null,e=0;e<c.length;e++)if(c[e][a]==b){d=e;break}return d},Array.prototype.chunk=function(a,b){var c,d=this,e="",f=0,g=-1,h=d.length||0,i=[];if(1>a)return null;if("[object Array]"===Object.prototype.toString.call(d))if(b)for(;h>f;)(c=f%a)?i[g][f]=d[f]:i[++g]={},i[g][f]=d[f],f++;else for(;h>f;)(c=f%a)?i[g][c]=d[f]:i[++g]=[d[f]],f++;else if(b)for(e in d)d.hasOwnProperty(e)&&((c=f%a)?i[g][e]=d[e]:i[++g]={},i[g][e]=d[e],f++);else for(e in d)d.hasOwnProperty(e)&&((c=f%a)?i[g][c]=d[e]:i[++g]=[d[e]],f++);return i},yamba.App=angular.module(yamba.appname,["ngRoute","ngCookies","ui.router","ngFileUpload","infinite-scroll","angularModalService"]),yamba.App.value("profile_cover",{cover:null,id:0}),yamba.App.value("follower_id",0),yamba.App.value("following_id",0);var Notifier={currentTimer:null,show:function(a,b,c){var d=$("#notification");if(d.length>0){var e=angular.extend({display:"block"},b||{});d.css(e).html("<h1>"+a+"</h1>"),"number"==typeof c&&(null!=Notifier.currentTimer&&clearTimeout(Notifier.currentTimer),Notifier.currentTimer=setTimeout(function(){Notifier.hide()},c))}},hide:function(){var a=$("#notification");a.length>0&&a.css({display:"none"}).html("")}};yamba.App.filter("ybDisplayTimeDiff",function(){return function(a,b){if(b=b||!1,angular.isArray(a))return"now";var c="";for(var d in a)label=d,b&&(label=d.toString().ucfirst()),c+=a[d]+" "+label+" ";return""==c&&(c="now"),c}}),yamba.App.filter("ybImagePath",function(){return function(a){return"undefined"==typeof a||null==a||"null"==a?"":/services/gi.test(a.toString())?"http://yamba.rocks/"+a:"http://yamba.rocks/services/"+a}}),yamba.App.filter("ybMediaType",function(){return function(a){return"direct"==a||"youtube"==a?"Video":"null"==a?"Image":"Type Not Found"}}),String.prototype.ucfirst=function(){str=""+this;var a=str.charAt(0).toUpperCase();return a+str.substr(1)},yamba.App.filter("ybStringLimit",function(){return function(a,b){return a.length>b?a.substring(0,b)+"...":a}}),yamba.App.factory("BaseServices",["$http","$location","Upload","CookieServices",function(a,b,c,d){return{_UserCookie:"USER",getSession:function(a){return d.get(a)},_getToken:function(){var a=d.get(this._UserCookie),b="";return"undefined"!=typeof a&&"undefined"!=typeof a.token&&(b=a.token),b},isLogin:function(){var a=d.get(this._UserCookie);return"undefined"!=typeof a&&"undefined"!=a.token&&"undefined"!=a.id?!0:!1},_request:function(c,d,e,f,g){var h=this._getToken();e=angular.extend({token:h},e),a({url:services_url+c,method:d,data:$.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded;charset=utf-8"}}).success(function(a){"undefined"==typeof a.error||"Unauthorized 101"!=a.error&&"Invalid token"!=a.error?f(a):b.path("login")},function(){"function"==typeof g&&g()})},_appendDataToUrl:function(a,b){var c="";for(var d in b)""!=c&&(c+="&"),c+=d+"="+b[d];return a+="?token="+this._getToken()+"&"+c},put:function(a,b,c,d){a=this._appendDataToUrl(a,b),this._request(a,"PUT",b,c,d)},get:function(a,b,c){this._request(a,"GET",null,b,c)},post:function(a,b,c,d){this._request(a,"POST",b,c,d)},"delete":function(a,b,c){this._request(a,"DELETE",null,b,c)},upload:function(a,b,d,e,f){var g=this._getToken();data=angular.extend({token:g},e),c.upload({url:services_url+a,fields:data,file:b,fileFormDataName:d}).success(function(a,b,c,d){f(a,b,c,d)})}}}]),yamba.App.factory("BoxServices",["CookieServices","BaseServices",function(a,b){return{boxes:[],getBox:function(a){var c=this;0!=this.boxes.length?a(this.boxes):b.post("api/box",{method:"get"},function(b){c.boxes=b,a(b)})},getUserBox:function(a,c){var d=angular.extend({method:"getUsers",circle_id:0},a||{});b.post("api/box",d,c)},editBox:function(a,c){var d=angular.extend({method:"editBox",circle_id:0,title:""},a||{});b.post("api/box",d,c)},addRemoveUserInBox:function(a,c){var d=angular.extend({method:"addRemoveBox",circle_id:0,user_id:0},a||{});b.post("api/box",d,c)},addUserToBox:function(a,c,d){b.post("api/box",{circle_id:a,user_id:c,method:"addRemoveBox"},d)}}}]),yamba.App.factory("CommentServices",["CookieServices","BaseServices",function(a,b){return{createComment:function(a,c,d){angular.isObject(a)&&(a.method="createComment",b.post("api-2/comment",a,c,d))},fetchComments:function(a,c,d){angular.isObject(a)&&(a.method="fetchComment",b.post("api-2/comment",a,c,d))},deleteComment:function(a,c,d){angular.isUndefined(a)||b["delete"]("api/comment?comment_id="+a,c,d)}}}]),yamba.App.factory("CookieServices",["$cookies","$cookieStore",function(a,b){return{_concatSessionId:function(a){return"undefined"==typeof session_id?a:session_id+"_"+a},get:function(a){return a=this._concatSessionId(a),b.get(a)},put:function(a,c){a=this._concatSessionId(a),b.put(a,c)},remove:function(a){a=this._concatSessionId(a),b.remove(a)},clean:function(){angular.forEach(a,function(a,c){b.remove(c)})}}}]),yamba.App.factory("FavoServices",["CookieServices","BaseServices","UserServices","$window","$timeout","$stateParams",function(a,b,c,d,e,f){var g=function(){this.items=[],this.busy=!1,this.after=0};return g.prototype.nextPage=function(){var a={lines:13,length:0,width:4,radius:51,corners:1,rotate:52,direction:1,color:"#000",speed:1.3,trail:25,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"50%",left:"50%"},g=document.getElementById("thespinner");if(!this.busy){this.busy=!0;var h=new d.Spinner(a).spin();g.appendChild(h.el);var i=0;console.log(f.username),c.profile({method:"fetchByUsername",username:f.username},function(a){console.log(a),i=a.data.User.user_id,b.post("/api/favo",{method:"fetchUserFavo",user_id:a.data.User.user_id,offset:this.after},function(a){var b=a.data,c=b.length;console.log(b.length);for(var d=0;c>d;d++)this.items.push(b[d]);this.after++,this.busy=!1,10>c&&(this.busy=!0)}.bind(this))}.bind(this)),e(function(){h.stop()},500)}},{relatedFavos:function(a,c){var d={project_id:a};b.post("api-2/relatedfavo",d,c)},fetchFavoList:function(a,c){var d=angular.extend({method:"fetch"},a||{});b.post("api/favo",d,c)},addProjectToFavo:function(a,c){var d=angular.extend({method:"addToFavo"},a||{});b.post("api/favo",d,c)},createFavo:function(a,c,d,e){var f=angular.extend({method:"create"},d||{});b.upload("api/favo",a,c,f,e)},fetchSpecificFavo:function(a,c){var d=angular.extend({method:"fetchAFavo"},a||{});b.post("api/favo",d,c)},fetchFavoPost:function(a,c){var d=angular.extend({method:"fetchPosts",offset:"0"},a||{});b.post("api/favo",d,c)},fetchFavoUser:g}}]),yamba.App.factory("FeedServices",["CookieServices","BaseServices",function(a,b){return{classes:["w1","w2","w3"],relatedPost:function(a,c){var d={project_id:a};b.post("api-2/relatedpost",d,c)},getActivityFeeds:function(a,c){var a=angular.extend({offset:0},a);b.post("api/activityfeed",a,c)},getFeaturedFeeds:function(a,c){var a=angular.extend({offset:0},a);b.post("api/featured",a,c)},getFeedByProjectId:function(a,c){b.post("api/specificprofilepost",{project_id:a},c)},getFeedsByHashtag:function(a,c){var a=angular.extend({offset:0,method:"fetchByHashtagName"},a);b.post("api-2/feedsearch",a,c)},getFeedsTrending:function(a,c){var a=angular.extend({offset:0,method:"fetchTrending",creation_date:"today"},a);b.post("api/explore",a,c)},getPostMedia:function(a,c){var d=angular.extend({method:"fetchEmbedded",project_id:0},a);b.post("api-2/project",d,c)},getMyPost:function(a,c){var d=angular.extend({offset:0},a);b.post("api/userprofileposts",d,c)},getMyLikePost:function(a,c){var d=angular.extend({offset:0},a);b.post("api/getlikesposts",d,c)}}}]),yamba.App.factory("FollowServices",["CookieServices","BaseServices","$window","$timeout",function(a,b){return{followUnfollow:function(a,c){b.post("/api/follow",{user_id:a},c)},checkFollowStatus:function(a,c){b.post("/api/follow",{method:"checkFollowStatus",subject_id:a},c)},fetchFollowers:function(a,c){b.post("/api/follow",{method:a.filter,subject_id:a.user_id,offset:a.offset},c)},confirmFollowRequest:function(a,c){b.post("api/follow",{method:"confirm",subject_id:a},c)},ignoreFollowRequest:function(a,c){b.post("api/follow",{method:"ignore",subject_id:a},c)},followStatus:function(a,b){return a=parseInt(a),b=parseInt(b),0==a&&0==b?"Follow":0==a&&1==b?"For Approval":1==a&&0==b?"Following":"Follow status not found."}}}]),yamba.App.factory("FollowerFactory",["CookieServices","BaseServices","UserServices","$window","$timeout","$stateParams",function(a,b,c,d,e,f){var g=function(){this.items=[],this.busy=!1,this.after=0};return g.prototype.nextPage=function(a){var g={lines:13,length:0,width:4,radius:51,corners:1,rotate:52,direction:1,color:"#000",speed:1.3,trail:25,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"50%",left:"50%"},h=document.getElementById("thespinner");if(!this.busy){this.busy=!0;var i=new d.Spinner(g).spin();h.appendChild(i.el);var j=0;console.log(f.username),c.profile({method:"fetchByUsername",username:f.username},function(c){console.log(c),j=c.data.User.user_id,b.post("/api/follow",{method:a,user_id:c.data.User.user_id,offset:this.after},function(a){var b=a.data,c=b.length;console.log(b.length);for(var d=0;c>d;d++)this.items.push(b[d]);this.after++,this.busy=!1,10>c&&(this.busy=!0)}.bind(this))}.bind(this)),e(function(){i.stop()},500)}},g}]),yamba.App.factory("HashtagServices",["CookieServices","BaseServices","UserServices","$window","$timeout","$stateParams",function(a,b,c,d,e,f){var g=function(){this.items=[],this.busy=!1,this.after=0};return g.prototype.nextPage=function(){var a={lines:13,length:0,width:4,radius:51,corners:1,rotate:52,direction:1,color:"#000",speed:1.3,trail:25,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"50%",left:"50%"},g=document.getElementById("thespinner");if(!this.busy){this.busy=!0;var h=new d.Spinner(a).spin();g.appendChild(h.el);var i=0;console.log(f.username),c.profile({method:"fetchByUsername",username:f.username},function(a){console.log(a),i=a.data.User.user_id,b.post("/api-2/hashtag",{method:"fetchFollowedHashtag",user_id:a.data.User.user_id,offset:this.after},function(a){var b=a.data,c=b.length;console.log(b.length);for(var d=0;c>d;d++)this.items.push(b[d]);this.after++,this.busy=!1,10>c&&(this.busy=!0)}.bind(this))}.bind(this)),e(function(){h.stop()},500)}},{followUnfollowHashtag:function(a,c,d){var e=angular.extend({method:"followHashtag"},a);b.post("api/hashtag",e,c,d)},getPostHashtag:function(a,c,d){b.post("api/hashtagposts",a,c,d)},fetchHashtag:function(a,c,d){a.method="fetchFollowedHashtag",b.post("api/hashtagposts",a,c,d)},getFeedsByHashtag:function(a,c){var a=angular.extend({offset:0,method:"fetchByHashtagName"},a);b.post("api-2/feedsearch",a,c)},getHashtagInfo:function(a,c){var d={method:"fetchByHashtagname",text:a};b.post("api-2/hashtag",d,c)}}}]),yamba.App.factory("LikeServices",["CookieServices","BaseServices",function(a,b){return{likeUnliked:function(a,c){b.post("/api/like",{project_id:a,type:"post"},c)}}}]),yamba.App.factory("NotificationServices",["CookieServices","BaseServices",function(a,b){return{generalNotification:function(a,c){var d=angular.extend({method:"general",offset:0,limit:30},a||{});b.post("api/notification",d,c)},requestNotification:function(a,c){var d=angular.extend({method:"request",offset:0,limit:30},a||{});b.post("api/notification",d,c)}}}]),yamba.App.factory("PostServices",["CookieServices","BaseServices",function(a,b){return{myPost:function(a,c,d){var e={};e.offset=a,b.post("api/myposts",e,c,d)},getPostByProjectId:function(a,c,d,e){var f={};f.user_id=a,f.project_id=c,b.post("api/specificprofilepost",f,d,e)},uplaodNewPost:function(a,c,d,e){var f=angular.extend({method:"create",title:"",description:"",hashtags:"",searchable:1,allow_downloadable_original:1,privacy:"everyone",auth_comment:"everyone"},d||{});b.upload("api-2/project",a,c,f,e)}}}]),yamba.App.factory("SearchServices",["CookieServices","BaseServices",function(a,b){return{searchHashtag:function(a,c){a=angular.extend({method:"fetchHashtag",offset:0},a),b.post("api-2/search",a,c)},searchFeed:function(a,c){a=angular.extend({method:"fetchMedia",offset:0},a),b.post("api/search",a,c)},searchUser:function(a,c){a=angular.extend({method:"fetchUser",offset:0},a),b.post("api/search",a,c)},searchFavo:function(a,c){a=angular.extend({method:"fetchFavo",offset:0},a),b.post("api/search",a,c)}}}]),yamba.App.factory("SettingsServices",["CookieServices","BaseServices",function(a,b){return{updateGeneralInfo:function(a,c){var d=angular.extend({method:"changeGeneralInfo"},a);b.post("api-2/settings",d,c)}}}]),yamba.App.factory("StaticDataServices",["CookieServices","BaseServices",function(){return{getTimezone:function(){return[{name:"US/Pacific",utc:"(UTC-8) Pacific Time (US & Canada)"},{name:"US/Mountain",utc:"(UTC-7) Mountain Time (US & Canada)"},{name:"US/Central",utc:"(UTC-6) Central Time (US & Canada)"},{name:"US/Eastern",utc:"(UTC-5) Eastern Time (US & Canada)"},{name:"America/Halifax",utc:"(UTC-4)  Atlantic Time (Canada)"},{name:"America/Anchorage",utc:"(UTC-9)  Alaska (US & Canada)"},{name:"Pacific/Honolulu",utc:"(UTC-10) Hawaii (US)"},{name:"Pacific/Samoa",utc:"(UTC-11) Midway Island, Samoa"},{name:"Etc/GMT-12",utc:"(UTC-12) Eniwetok, Kwajalein"},{name:"Canada/Newfoundland",utc:"(UTC-3:30) Canada/Newfoundland"},{name:"America/Buenos_Aires",utc:"(UTC-3) Brasilia, Buenos Aires, Georgetown"},{name:"Atlantic/South_Georgia",utc:"(UTC-2) Mid-Atlantic"},{name:"Atlantic/Azores",utc:"(UTC-1) Azores, Cape Verde Is."},{name:"Europe/London",utc:"Greenwich Mean Time (Lisbon, London)"},{name:"Europe/Berlin",utc:"(UTC+1) Amsterdam, Berlin, Paris, Rome, Madrid"},{name:"Europe/Athens",utc:"(UTC+2) Athens, Helsinki, Istanbul, Cairo, E. Europe"},{name:"Europe/Moscow",utc:"(UTC+3) Baghdad, Kuwait, Nairobi, Moscow"},{name:"Iran",utc:"(UTC+3:30) Tehran"},{name:"Asia/Dubai",utc:"(UTC+4) Abu Dhabi, Kazan, Muscat"},{name:"Asia/Kabul",utc:"(UTC+4:30) Kabul"},{name:"Asia/Yekaterinburg",utc:"(UTC+5) Islamabad, Karachi, Tashkent"},{name:"Asia/Dili",utc:"(UTC+5:30) Bombay, Calcutta, New Delhi"},{name:"Asia/Katmandu",utc:"(UTC+5:45) Nepal"},{name:"Asia/Omsk",utc:"(UTC+6) Almaty, Dhaka"},{name:"India/Cocos",utc:"(UTC+6:30) Cocos Islands, Yangon"},{name:"Asia/Krasnoyarsk",utc:"(UTC+7) Bangkok, Jakarta, Hanoi"},{name:"Asia/Hong_Kong",utc:"(UTC+8) Beijing, Hong Kong, Singapore, Taipei"},{name:"Asia/Tokyo",utc:"(UTC+9) Tokyo, Osaka, Sapporto, Seoul, Yakutsk"},{name:"Australia/Adelaide",utc:"(UTC+9:30) Adelaide, Darwin"},{name:"Australia/Sydney",utc:"(UTC+10) Brisbane, Melbourne, Sydney, Guam"},{name:"Asia/Magadan",utc:"(UTC+11) Magadan, Soloman Is., New Caledonia"},{name:"Pacific/Auckland",utc:"(UTC+12) Fiji, Kamchatka, Marshall Is., Wellington"}]}}}]),yamba.App.factory("UserServices",["CookieServices","BaseServices","$http","$q",function(a,b,c,d){return{getLoginUser:function(){return b.getSession(b._UserCookie)},login:function(c,d,e,f){var g=b._UserCookie;b.post("api/auth",{identity:c,password:d},function(b){if("undefined"==typeof b.error&&"undefined"!=typeof b.User){var c=angular.copy(b.User);c.token=b.token,a.put(g,c),e(b)}else f(b)},f)},register:function(a,c,d){angular.isObject(a)&&(a.method="add",b.post("api/register",a,c,d))},isLogin:function(){return b.isLogin()},logout:function(){a.clean()},profile:function(a,c){b.post("api-2/user",a,c)},profile2:function(a){var b=d.defer();return c.post("api-2/user",$.param({method:"fetchByUsername",username:a})).success(function(a){b.resolve(a)}).error(function(a){b.reject(a)}),b.promise}}}]),yamba.App.factory("serializeFormPostData",serializeFormPostData),yamba.App.directive("ybHtmlUnsafe",["$sce",function(a){return{restrict:"AC",scope:{ybHtmlUnsafe:"="},template:"<div ng-bind-html='trustedHtml'></div>",link:function(b){b.updateHtml=function(){b.trustedHtml=a.trustAsHtml(b.ybHtmlUnsafe)},b.$watch("ybHtmlUnsafe",function(){"undefined"!=typeof b.ybHtmlUnsafe&&b.updateHtml()})}}}]),yamba.App.directive("ybTextBoxLimit",["$timeout",function(){return{restrict:"AC",scope:{},link:function(a,b,c){var d=0,e=$("#"+c.ybTextboxCounterContainer),f=parseInt(c.ybTextBoxLimit);e.html("0 / "+f),$(b).unbind("keypress").bind("keypress",function(){d=parseInt(this.value.length)+1,d>=f&&(this.value=this.value.toString().substring(0,f-1),d=f),e.length>0&&e.html(d+" / "+f)})}}}]),yamba.App.directive("ybRelatedFavos",["$timeout",function(){return{restrict:"AC",scope:{favos:"="},templateUrl:"app/views/directives/favos/related-favos.php"}}]),yamba.App.directive("ybFeed",["LikeServices","ModalService",function(a,b){return{restrict:"CA",scope:{data:"=record",view:"@"},templateUrl:function(a,b){return"app/views/directives/post/feed-"+b.view+".php"},link:function(c){c.addCollection=function(a){b.showModal({templateUrl:"app/views/modal/collecton.php",controller:"ModalCollectionController",inputs:{post:a}}).then(function(a){a.close.then(function(){})})},c.likeFeed=function(b){a.likeUnliked(b.project_id,function(a){{var d=b.scope_ctr,e=document.querySelectorAll("article"),f=angular.element(e[d]).find(".itemLikes");f.text()}a.data.islike?(f.addClass("liked instantAnimation pulse"),c.$parent.feeds[b.scope_ctr].like_count+=1,c.$parent.feeds[b.scope_ctr].like_count_int+=1):(f.removeClass("liked"),c.$parent.feeds[b.scope_ctr].like_count-=1,c.$parent.feeds[b.scope_ctr].like_count_int-=1)})},c.commentModal=function(a,c){b.showModal({templateUrl:"app/views/directives/post/comments.php",controller:"CommentController",inputs:{project_id:a,scope_ctr:c}}).then(function(a){a.close.then(function(){})})},c.deleteFeed=function(a){console.log(a)},c.feed_options=function(a){b.showModal({templateUrl:"app/views/modal/feed-options.php",controller:"FeedOptionsController",inputs:{user:a}}).then(function(a){a.close.then(function(){})})}}}}]),yamba.App.directive("ybFeeds",["$compile","$timeout","UserServices","FeedServices","HashtagServices","$document","$window","$state","FavoServices",function(a,b,c,d,e,f,g,h,i){var j=["w3","w2","w1","w1","w2","w3","w2","w1","w1","w1","w1","w3","w3","w2","w2","w2","w2","w3","w2","w1","w1","w2","w3","w2","w1","w1","w1","w1","w3","w2","w1","w1","w3","w3","w2","w2","w2","w2","w3","w2","w1","w1","w2","w3","w2","w1","w1","w1","w1","w3","w2","w1","w1","w3","w3","w2","w2","w2","w2"],k={mypost:0,mylikepost:0,activity:0,featured:0,hashtag:0,trending:0,favofeed:0},l={mypost:!1,mylikepost:!1,activity:!1,featured:!1,hashtag:!1,trending:!1},m=function(a,b,c,d){var e="",f=function(a){return j[a]};getHashtagColor=function(a){var b=null;return b=angular.isObject(a)?"rgb("+a.R+","+a.G+","+a.B+")":"rgb(31,32,33)"};for(var g=a.length-c;g<a.length;g++){var h=f(k[d]),i=getHashtagColor(a[g].Image_color);a[g].hashtag_color=i,a[g].scope_ctr=g,e+='<figure class="item animated fadeIn '+h+'" yb-feed record="feeds[ '+g+' ]" view="'+h+'" hashtag_color="'+i+'"></figure>',58==k[d]?k[d]=0:k[d]++}return e},n={mypost:function(a,b){console.log(a),c.profile({method:"fetchByUsername",username:a.username},function(c){a=angular.extend({user_id:c.data.User.user_id},a),d.getMyPost(a,function(a){b(a.Posts)})})},mylikepost:function(a,b){console.log(a),c.profile({method:"fetchByUsername",username:a.username},function(c){a=angular.extend({user_id:c.data.User.user_id},a),d.getMyLikePost(a,function(a){b(a.my_likes)})})},activity:function(a,b){d.getActivityFeeds(a,function(a){b(a.Activity_Feed)})},featured:function(a,b){d.getFeaturedFeeds(a,function(a){b(a.Activity_Feed)})},hashtag:function(a,b){e.getFeedsByHashtag(a,function(a){b(a.data)})},trending:function(a,b){d.getFeedsTrending(a,function(a){b(a.Activity_Feed)})},favofeed:function(a,b){i.fetchFavoPost(a,function(a){b(a.data.Favo_Feed)})}};return{restrict:"E",scope:{filter:"=",type:"@",callback:"&"},link:function(c,e){c.feeds=[],c.likePost=function(a){console.log(a)};var f,i,j={lines:13,length:0,width:4,radius:51,corners:1,rotate:52,direction:1,color:"#000",speed:1.3,trail:25,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"50%",left:"50%"},o=document.getElementById("thespinner"),p=angular.copy(c.filter)||{};p=angular.extend({offset:0},p);var q=function(){if(p.offset>=100||1==l[c.type])return void(l[c.type]=!0);if("undefined"!=typeof n[c.type]){0==p.offset&&(k[c.type]=0);var h=new g.Spinner(j).spin(o);n[c.type](p,function(g){g.length<=9&&(l[c.type]=!0),c.feeds=c.feeds.merge(g),f=m(c.feeds,d.classes,g.length,c.type),i=a(f)(c),e.append(i),b(function(){$(".masonry").masonry({columnWidth:20,itemSelector:".item"}),$(".masonry").masonry("reloadItems"),$(".masonry").masonry("layout"),h.stop()},500),"function"==typeof c.callback&&c.callback({feeds:c.feeds})})}p.offset++};q(),$(window).scroll(function(){var a=$(document).height()-$(window).height()-$(window).scrollTop();0==a&&(h.is("main.activity_feed")||h.is("main.hashtag")||h.is("main.featured")||h.is("main.trending")||h.is("main.profile")||h.is("main.favo"))&&q()})}}}]),yamba.App.directive("ybNotificationMessageBuilder",["$timeout","FollowServices",function(a,b){return{restrict:"AC",scope:{layout:"@",message:"="},templateUrl:function(){return"app/views/directives/notifications/layout.php"},link:function(a,c){a.confirmFollowRequest=function(a,d){1==a?b.confirmFollowRequest(d,function(){}):b.ignoreFollowRequest(d,function(){}),$(c).remove()}}}}]),yamba.App.directive("ybPostMedia",["$timeout","$sce","FeedServices",function(a,b,c){return{restrict:"AC",scope:{project:"="},templateUrl:"app/views/directives/post/post-media.php",link:function(a){a.render={image:!1,embedded:!1},a.embedded=[];var d=/(http|ftp|https):\/\/[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#-]*[\w@?^=%&amp;\/~+#-])/gi,e=function(a){return'<iframe width="560" height="315" src="'+a+'" frameborder="0" allowfullscreen></iframe>'},f=!1,g=navigator.userAgent.toLowerCase();g.indexOf("firefox")>-1&&(f=!0);var h=function(){c.getPostMedia({project_id:a.project.project_id},function(c){a.embed="";for(var g,h="",i=0;i<c.data.Embedded.length;i++){h=c.data.Embedded[i],f?a.embed=b.trustAsHtml(h):(g=h.toString().match(d),a.embed=b.trustAsHtml(e(g[0])));break}})};a.$watch("project",function(){angular.isObject(a.project)&&angular.isObject(a.project.Media)&&("null"==a.project.Media.type?a.render.image=!0:(a.render.embedded=!0,h()))})}}}]),yamba.App.directive("ybRelatedPost",["$timeout",function(){return{restrict:"AC",scope:{projects:"="},templateUrl:"app/views/directives/post/related-post.php"}}]),yamba.App.directive("followInfo",function(){var a={restrict:"EA",templateUrl:"app/views/directives/user/follow-info.php",scope:{data:"=",method:"="},link:function(a){a.follow=function(a){console.log(a)},a.unfollow=function(a){console.log(a)}}};return a}),yamba.App.directive("profileFeed",["FollowServices",function(){var a={restrict:"EA",templateUrl:"app/views/user/profile/profile-feeds.php",scope:{filter:"="}};return a}]),yamba.App.directive("profileHeader",["FollowServices",function(a){var b={restrict:"EA",templateUrl:"app/views/user/profile/profile-header.php",scope:{data:"=",cover:"=",follow:"=",group:"="},link:function(b){b.followButtonFunction=function(b){a.followUnfollow(b,function(b){var c=a.followStatus(b.is_followed,b.pending_approval);angular.element(document.getElementById("follow_status")).html(c)})}}};return b}]),yamba.App.controller("LeftMenuController",["$scope","BoxServices",function(a){a.boxes=[],a.$watch("$parent.Constant.boxes",function(){0!=a.$parent.Constant.boxes.length&&(a.boxes=a.$parent.Constant.boxes)})}]),yamba.App.controller("ModalBoxController",["$scope","user","close","BoxServices",function(a,b,c,d){a.display=!0,a.user=b,a.boxes=[],d.getBox(function(b){a.boxes=b.Box.chunk(3)}),a.addBox=function(b){d.addUserToBox(b,a.user.user_id,function(){})},a.close=function(){a.display=!1,c()}}]),yamba.App.controller("ModalCollectionController",["$scope","$timeout","FavoServices","post",function(a,b,c,d){a.display=!0,a.collections=[],a.fileReaderSupported=null!=window.FileReader&&(null==window.FileAPI||0!=FileAPI.html5),c.fetchFavoList({},function(b){a.collections=b.data}),a.generateThumb=function(c){null!=c&&a.fileReaderSupported&&c.type.indexOf("image")>-1&&b(function(){var a=new FileReader;a.readAsDataURL(c),a.onload=function(a){b(function(){c.dataUrl=a.target.result})}})},a.addCollection=function(b){Notifier.show("Uploading.. Please wait."),b.$valid&&c.createFavo(a.collection.file,"Filedata",{title:a.collection.name,privacy:a.collection.privacy,category:""},function(b){a.selected_collection=b.data.favcircle_id,a.addProject(),Notifier.hide(),a.close()})},a.addProject=function(){c.addProjectToFavo({project_id:d.project_id,favcircle_id:a.selected_collection},function(){a.close()})},a.close=function(){a.display=!1,close()}}]),yamba.App.controller("ModalRepostController",["$scope","post","close",function(a,b,c){a.display=!0,a.post=b,a.repostPost=function(){alert("no repost api but after this is done."),a.close()},a.close=function(){a.display=!1,c()}}]),yamba.App.controller("NewPostController",["$scope","UserServices","PostServices",function(a,b,c){a.current_user=b.getLoginUser(),a.fileReaderSupported=null!=window.FileReader&&(null==window.FileAPI||0!=FileAPI.html5);var d=function(){a.post={privacy:"public",title:"",description:"",hashtags:""},a.newPostError="",a.upload_type=""};d(),a.closeModal=function(){delete a.files,d(),$("#newPostContainer").css({display:"none"})},a.showUploadForm=function(b){a.upload_type=b,$("#uploadMediaStep1").css({display:"none"}),$("#uploadMediaStep2").css({display:"block"}),$("#uploadMediaStep3").css({display:"none"})},a.nextNewPostForm=function(){"undefined"!=typeof a.files&&($("#uploadMediaStep1").css({display:"none"}),$("#uploadMediaStep2").css({display:"none"}),$("#uploadMediaStep3").css({display:"block"}))};var e=function(a,b,c){var d="",e=a.length,f="";e>3&&(e=3);for(var g=0;e>g;g++)d=a[g],d=d.replace(/[!@#\$%\^\&*\)\(+=._,]+/g,""),1==b&&(d="#"+d),f+=d,f+=1==c?",":" ";return f};a.hashtagCheker=function(){var b=a.post.hashtags.toString().match(/[\w#]+/g);a.post.hashtags=e(b,!0,!1)},a.newPostSubmit=function(){var b={title:a.post.title,description:a.post.description,privacy:a.post.privacy,hashtags:""},d=a.post.hashtags.toString().match(/[\w#]+/g);b.hashtags=e(d,!1,!0),Notifier.show("Uploading... Please wait..."),c.uplaodNewPost(a.files,"Filedata",b,function(b){"undefined"!=typeof b.data?a.closeModal():a.newPostError="Error",Notifier.hide()})}}]),yamba.App.controller("SearchFormController",["$scope","$state",function(a,b){a.searchKeyword=function(c){c.$valid&&(a.closeSearchModal(),b.go("main.search",{keyword:a.search.keyword}))},a.closeSearchModal=function(){$("#searchContainerForm").css({display:"none"})}}]),yamba.App.controller("TopNavController",["$scope","$state",function(a){a.showLeftMenuCanvas=function(){var a=$("#leftMenuCanvas"),b=$("#mainAppCanvas");a.hasClass("leftMenuCanvasHidden")?(a.removeClass("leftMenuCanvasHidden"),b.addClass("mainAppCanvasVisible")):(a.addClass("leftMenuCanvasHidden"),b.removeClass("mainAppCanvasVisible"))},a.showTrendingModal=function(){$("#trendingContainerForm").css({display:"block"})},a.showSearchForm=function(){$("#searchContainerForm").css({display:"block"}),$("#searchFormInput").focus()},a.showNewPostModal=function(){$("#uploadMediaStep3").css({display:"none"}),$("#uploadMediaStep2").css({display:"none"}),$("#uploadMediaStep1").css({display:"block"}),$("#newPostContainer").css({display:"block"})}}]),yamba.App.controller("TrendingModalController",["$scope","$state","FeedServices",function(a,b,c){a.current_filter="today",a.loadingTrend=!1,a.trending=[];var d=0;a.closeTrendingModal=function(){$("#trendingContainerForm").css({display:"none"})},a.changeTrending=function(b){a.trending=[],d=0,showTrending({creation_date:b})},a.showMoreTrending=function(){d++,showTrending(a.current_filter,!0)},showTrending=function(b,e){e=!!e;var f=angular.extend({creation_date:"today",offset:d},b);a.current_filter=f.creation_date,a.loadingTrend=!0,c.getFeedsTrending(f,function(b){e?a.trending.merge(b.Activity_Feed):a.trending=b.Activity_Feed,a.loadingTrend=!1})},showTrending({creation_date:"today"})}]),yamba.App.controller("ActivityFeedController",["$scope","$stateParams","FeedServices",function(a,b){a.$parent.App.title="Activity Feed",a.activity_feed_filter={},"undefined"!=typeof b.box_id&&(a.activity_feed_filter={circle_id:b.box_id})}]),yamba.App.controller("AddGroupController",["$scope","close",function(a,b){a.display=!0,a.close=function(){a.display=!1,b()}}]),yamba.App.controller("AppController",["$scope","$state","UserServices","BoxServices",function(a,b,c,d){a.App={title:"Welcome test",user:{}},a.Constant={boxes:[]},d.getBox(function(b){a.Constant.boxes=b.Box}),c.isLogin()&&(a.App.user=c.getLoginUser()),a.logout=function(){c.logout(),b.go("login")}}]),yamba.App.controller("CollectionsController",["$scope","$stateParams","UserServices","FollowServices","profile_cover","FavoServices",function(a,b,c,d,e,f){a.user_data={},a.random_cover=e.cover,console.log(e.cover),a.favos=new f.fetchFavoUser,a.follow=[my_profile=!1,follow_status=""],c.profile({method:"fetchByUsername",username:b.username},function(b){var f=b.data.User,g=!1;a.user_data=f,a.$parent.App.user.user_id==f.user_id?(g=!0,a.follow.my_profile=g,a.follow.follow_status=""):d.checkFollowStatus(a.user_data.user_id,function(b){e.id!=f.user_id&&(e.cover=null,e.id=0);var b=b.data[0].Follow,c=d.followStatus(b.is_followed,b.pending_approval);a.follow.my_profile=g,a.follow.follow_status=c}),c.profile({method:"fetchPosts",offset:0,user_id:f.user_id},function(b){if(null==e.cover){var c=b.data.cover_photo;e.cover=c,e.id=f.user_id,a.random_cover=c}else a.random_cover=e.cover})})}]),yamba.App.controller("CommentController",["$scope","close","project_id","scope_ctr","CommentServices",function(a,b,c,d,e){a.display=!0,a.hasMoreComment=!1,a.comments=[];var f=0,g=function(){e.fetchComments({project_id:c,page:f},function(b){for(var c=b.data,d=0;d<a.comments.length;d++)c.push(a.comments[d]);a.comments=c,a.hasMoreComment=f>=b.total_pager?!1:!0,f++})};g(),a.loadMoreComment=function(){console.log("loading more comments"),g()};var h=!1;a.submitComment=function(b){b.$valid&&!h&&(h=!0,e.createComment({project_id:c,body:a.form.comment.body},function(b){a.form.comment.body="",a.comments.push(b.data);var c=document.querySelectorAll("article"),e=angular.element(c[d]).find(".itemComments"),f=a.comments.length;console.log(f),e.html(f),console.log(" -- newly added --",a.comments),h=!1}))},a.close=function(){a.display=!1,b()}}]),yamba.App.controller("FavoController",["$scope","$timeout","$stateParams","FavoServices",function(a,b,c,d){a.$parent.App.title="Favo",a.favo={},a.favoFilter={favcircle_id:c.favo_id},d.fetchSpecificFavo({favcircle_id:c.favo_id},function(b){a.favo=b.data.Favo})}]),yamba.App.controller("FeaturedController",["$scope","$timeout","FeedServices",function(a){a.$parent.App.title="Featured";

}]),yamba.App.controller("FollowerController",["$scope","$stateParams","UserServices","FollowServices","profile_cover","follower_id","FollowerFactory",function(a,b,c,d,e,f,g){a.user_data={},a.current_id=f,a.random_cover=e.cover,console.log(e.cover),a.follow=[my_profile=!1,follow_status=""],a.follows=0,a.title="Following",a.follow_service=new g,console.log("Follow Services"),console.log(a.follow_service),a.fetch_method="fetchFollowers",c.profile({method:"fetchByUsername",username:b.username},function(b){var f=b.data.User,g=!1;a.user_data=f,a.$parent.App.user.user_id==f.user_id?(g=!0,a.follow.my_profile=g,a.follow.follow_status=""):d.checkFollowStatus(a.user_data.user_id,function(b){e.id!=f.user_id&&(e.cover=null,e.id=0);var b=b.data[0].Follow,c=d.followStatus(b.is_followed,b.pending_approval);a.follow.my_profile=g,a.follow.follow_status=c}),c.profile({method:"fetchPosts",offset:0,user_id:f.user_id},function(b){if(null==e.cover){var c=b.data.cover_photo;e.cover=c,e.id=f.user_id,a.random_cover=c}else a.random_cover=e.cover})})}]),yamba.App.controller("FollowerController",["$scope","$stateParams","UserServices","FollowServices","profile_cover","follower_id","FollowerFactory",function(a,b,c,d,e,f,g){a.user_data={},a.current_id=f,a.random_cover=e.cover,console.log(e.cover),a.follow=[my_profile=!1,follow_status=""],a.follows=0,a.title="Following",a.follow_service=new g,console.log("Follow Services"),console.log(a.follow_service),a.fetch_method="fetchFollowers",c.profile({method:"fetchByUsername",username:b.username},function(b){var f=b.data.User,g=!1;a.user_data=f,a.$parent.App.user.user_id==f.user_id?(g=!0,a.follow.my_profile=g,a.follow.follow_status=""):d.checkFollowStatus(a.user_data.user_id,function(b){e.id!=f.user_id&&(e.cover=null,e.id=0);var b=b.data[0].Follow,c=d.followStatus(b.is_followed,b.pending_approval);a.follow.my_profile=g,a.follow.follow_status=c}),c.profile({method:"fetchPosts",offset:0,user_id:f.user_id},function(b){if(null==e.cover){var c=b.data.cover_photo;e.cover=c,e.id=f.user_id,a.random_cover=c}else a.random_cover=e.cover})})}]),yamba.App.controller("FollowingController",["$scope","$stateParams","UserServices","FollowServices","profile_cover","FollowerFactory",function(a,b,c,d,e,f){a.user_data={},a.current_id=0,a.random_cover=e.cover,console.log(e.cover),a.follow=[my_profile=!1,follow_status=""],a.follows=0,a.title="Following",a.follow_service=new f,a.fetch_method="fetchFollowing",c.profile({method:"fetchByUsername",username:b.username},function(b){var f=b.data.User,g=!1;a.user_data=f,a.current_id=f.user_id,a.$parent.App.user.user_id==f.user_id?(g=!0,a.follow.my_profile=g,a.follow.follow_status=""):d.checkFollowStatus(a.user_data.user_id,function(b){e.id!=f.user_id&&(e.cover=null,e.id=0);var b=b.data[0].Follow,c=d.followStatus(b.is_followed,b.pending_approval);a.follow.my_profile=g,a.follow.follow_status=c}),c.profile({method:"fetchPosts",offset:0,user_id:f.user_id},function(b){if(null==e.cover){var c=b.data.cover_photo;e.cover=c,e.id=f.user_id,a.random_cover=c}else a.random_cover=e.cover})})}]),yamba.App.controller("FollowingController",["$scope","$stateParams","UserServices","FollowServices","profile_cover","FollowerFactory",function(a,b,c,d,e,f){a.user_data={},a.current_id=0,a.random_cover=e.cover,console.log(e.cover),a.follow=[my_profile=!1,follow_status=""],a.follows=0,a.title="Following",a.follow_service=new f,a.fetch_method="fetchFollowing",c.profile({method:"fetchByUsername",username:b.username},function(b){var f=b.data.User,g=!1;a.user_data=f,a.current_id=f.user_id,a.$parent.App.user.user_id==f.user_id?(g=!0,a.follow.my_profile=g,a.follow.follow_status=""):d.checkFollowStatus(a.user_data.user_id,function(b){e.id!=f.user_id&&(e.cover=null,e.id=0);var b=b.data[0].Follow,c=d.followStatus(b.is_followed,b.pending_approval);a.follow.my_profile=g,a.follow.follow_status=c}),c.profile({method:"fetchPosts",offset:0,user_id:f.user_id},function(b){if(null==e.cover){var c=b.data.cover_photo;e.cover=c,e.id=f.user_id,a.random_cover=c}else a.random_cover=e.cover})})}]),yamba.App.controller("GroupController",["$scope","$stateParams","$state","BoxServices",function(a,b,c,d){if(0==a.$parent.Constant.boxes.length)return void c.go("main.activity_feed");var e=a.$parent.Constant.boxes.getIndexByKeyVal("circle_id",b.box_id);a.$parent.App.title="Groups",a.box_users=[],a.edit_group=!1,a.current_box={},a.box_name=a.$parent.Constant.boxes[e].title,d.getUserBox({circle_id:b.box_id},function(b){a.box_users=b.data}),a.saveGroupName=function(){d.editBox({circle_id:b.box_id,title:a.box_name},function(b){a.edit_group=!1,a.$parent.Constant.boxes[e].title=b.data.title})},a.addRemoveUserInBox=function(c,e){confirm("Are you sure you want to delete this?")&&d.addRemoveUserInBox({circle_id:b.box_id,user_id:c},function(b){"Removed"==b.data.message&&a.box_users.splice(e,1)})}}]),yamba.App.controller("HashtagController",["$scope","$timeout","$stateParams","HashtagServices",function(a,b,c,d){a.$parent.App.title="Hashtag",a.hashtag=c.hashtag,a.filterHashtag={text:c.hashtag},a.hashtag_info=null,a.headerBg="",a.afterFinish=function(b){"undefined"!=typeof b[0]&&(a.headerBg=b[0].Media.storage_path)},a.hashtagFollow=function(a){data={tag_id:a},d.followUnfollowHashtag(data,function(a){var b=document.getElementById("follow-hashtag"),c="Follow";if("Followed"==a.data.message)var c="Unfollow";angular.element(b).html(c)},function(){})},d.getHashtagInfo(c.hashtag,function(b){a.hashtag_info=b.data.Hashtag,a.hashtag_info.message=0==b.data.Hashtag.is_followed?"Follow":"Unfollow"})}]),yamba.App.controller("LikesController",["$scope","$stateParams","UserServices","FollowServices","profile_cover",function(a,b,c,d,e){a.user_data={},a.random_cover=e.cover,console.log(e.cover),a.follow=[my_profile=!1,follow_status=""],a.filterUser={username:b.username},c.profile({method:"fetchByUsername",username:b.username},function(b){var f=b.data.User,g=!1;a.user_data=f,a.$parent.App.user.user_id==f.user_id?(g=!0,a.follow.my_profile=g,a.follow.follow_status=""):d.checkFollowStatus(a.user_data.user_id,function(b){e.id!=f.user_id&&(e.cover=null,e.id=0);var b=b.data[0].Follow,c=d.followStatus(b.is_followed,b.pending_approval);a.follow.my_profile=g,a.follow.follow_status=c}),c.profile({method:"fetchPosts",offset:0,user_id:f.user_id},function(b){if(null==e.cover){var c=b.data.cover_photo;e.cover=c,e.id=f.user_id,a.random_cover=c}else a.random_cover=e.cover})})}]),yamba.App.controller("LoginController",["$scope","$timeout","$location","UserServices",function(a,b,c,d){a.$parent.App.title="Login",d.isLogin()&&c.path("/main/activity-feed"),a.authenticate=function(b){b.$valid&&d.login(a.username,a.password,function(b){a.$parent.App.user=b.User,c.path("/main/activity-feed")},function(b){a.errorMsg=b.error[0]})}}]),yamba.App.controller("NotificationController",["$scope","$state","$timeout","$stateParams","NotificationServices",function(a,b,c,d,e){a.$parent.App.title="Notification",a.notifications=[];var f=1;a.notification_type=d.type;var g=function(b){"request"==b?e.requestNotification({offset:f},function(b){a.notifications.merge(b.yamba)}):e.generalNotification({offset:f},function(b){a.notifications.merge(b.yamba)})};g(d.type),$(window).scroll(function(){var a=$(document).height()-$(window).height()-$(window).scrollTop();0==a&&b.is("main.notification")&&(f++,g(d.type))})}]),yamba.App.controller("PostViewController",["$scope","$stateParams","$timeout","FeedServices","FavoServices","CommentServices","LikeServices","FollowServices","ModalService","UserServices",function(a,b,c,d,e,f,g,h,i,j){a.project_id=b.project_id,a.hasMoreComment=!1,a.comments=[],a.post_data={},a.follow={},a.isOwner=!0,c(function(){$(document).scrollTop(0)});var k=j.getLoginUser(),l=function(a){i.showModal({templateUrl:"app/views/modal/box.php",controller:"ModalBoxController",inputs:{user:a}}).then(function(a){a.close.then(function(){})})},m=function(b){k.user_id!=b.user_id&&(a.isOwner=!1),h.checkFollowStatus(b.user_id,function(b){a.follow=b.data[0].Follow,a.follow.status_string=h.followStatus(a.follow.is_followed,a.follow.pending_approval)})};d.getFeedByProjectId(a.project_id,function(b){a.post_data=b.data.Posts[0],m(b.data.Posts[0].User)}),a.unfollowFollow=function(){h.followUnfollow(a.post_data.User.user_id,function(b){a.follow.status_string=h.followStatus(b.is_followed,b.pending_approval),1==b.is_followed&&0==b.pending_approval&&l(b.Users)})},a.likeUnliked=function(){g.likeUnliked(b.project_id,function(b){a.post_data.is_liked=b.data.islike?1:0})},a.addCollection=function(){i.showModal({templateUrl:"app/views/modal/collecton.php",controller:"ModalCollectionController",inputs:{post:a.post_data}}).then(function(a){a.close.then(function(){})})},a.sharePost=function(){i.showModal({templateUrl:"app/views/modal/repost.php",controller:"ModalRepostController",inputs:{post:a.post_data}}).then(function(a){a.close.then(function(){})})};var n=0,o=function(){f.fetchComments({project_id:a.project_id,page:n},function(b){for(var c=b.data,d=0;d<a.comments.length;d++)c.push(a.comments[d]);a.comments=c,a.hasMoreComment=n>=b.total_pager?!1:!0,n++})};o(),a.loadMoreComment=function(){console.log("loading more comments"),o()};var p=!1;a.submitComment=function(b){b.$valid&&!p&&(p=!0,f.createComment({project_id:a.project_id,body:a.form.comment.body},function(b){a.form.comment.body="",a.comments.push(b.data),console.log(" -- newly added --",a.comments),p=!1}))},e.relatedFavos(a.project_id,function(b){a.related_favos=b.RelatedFavo}),d.relatedPost(a.project_id,function(b){a.related_projects=b.RelatedPost})}]),yamba.App.controller("ProfileController",["$scope","$stateParams","$timeout","UserServices","FollowServices","ModalService","profile_cover",function(a,b,c,d,e,f,g){a.user_data={},a.random_cover=g.cover,console.log(g.cover),a.follow=[my_profile=!1,follow_status=""],a.filterUser={username:b.username},d.profile({method:"fetchByUsername",username:b.username},function(b){var c=b.data.User,f=!1;a.user_data=c,a.$parent.App.user.user_id==c.user_id?(f=!0,a.follow.my_profile=f,a.follow.follow_status=""):e.checkFollowStatus(a.user_data.user_id,function(b){g.id!=c.user_id&&(g.cover=null,g.id=0);var b=b.data[0].Follow,d=e.followStatus(b.is_followed,b.pending_approval);a.follow.my_profile=f,a.follow.follow_status=d}),d.profile({method:"fetchPosts",offset:0,user_id:c.user_id},function(b){if(null==g.cover){var d=b.data.cover_photo;g.cover=d,g.id=c.user_id,a.random_cover=d}else a.random_cover=g.cover})}),a.addGroup=function(a){f.showModal({templateUrl:"app/views/modal/box.php",controller:"ModalBoxController",inputs:{user:a}}).then(function(a){a.close.then(function(){})})}}]),yamba.App.controller("ProfileHashtagController",["$scope","$stateParams","UserServices","FollowServices","profile_cover","FollowerFactory",function(a,b,c,d,e){a.user_data={},a.current_id=0,a.random_cover=e.cover,a.follow=[my_profile=!1,follow_status=""],a.follows=0,a.title="Following",c.profile({method:"fetchByUsername",username:b.username},function(b){var f=b.data.User,g=!1;a.user_data=f,a.current_id=f.user_id,a.$parent.App.user.user_id==f.user_id?(g=!0,a.follow.my_profile=g,a.follow.follow_status=""):d.checkFollowStatus(a.user_data.user_id,function(b){e.id!=f.user_id&&(e.cover=null,e.id=0);var b=b.data[0].Follow,c=d.followStatus(b.is_followed,b.pending_approval);a.follow.my_profile=g,a.follow.follow_status=c}),c.profile({method:"fetchPosts",offset:0,user_id:f.user_id},function(b){if(null==e.cover){var c=b.data.cover_photo;e.cover=c,e.id=f.user_id,a.random_cover=c}else a.random_cover=e.cover})})}]),yamba.App.controller("RegisterController",["$scope",function(a){a.$parent.App.title="Registration"}]),yamba.App.controller("SearchController",["$scope","$timeout","$stateParams","SearchServices",function(a,b,c,d){a.$parent.App.title="Search | "+c.keyword,a.search={hashtags:[],feeds:[],users:[],favos:[]},d.searchHashtag({keyword:c.keyword},function(b){a.search.hashtags=b.Hashtag}),d.searchFeed({keyword:c.keyword},function(b){a.search.feeds=b.data}),d.searchUser({keyword:c.keyword},function(b){a.search.users=b.data}),d.searchFavo({keyword:c.keyword},function(b){a.search.favos=b.data})}]),yamba.App.controller("SettingsController",["$scope","$timeout","SettingsServices","UserServices","StaticDataServices",function(a,b,c,d,e){a.$parent.App.title="Settings",a.current_user=d.getLoginUser(),console.log(a.current_user),a.settings={timezones:e.getTimezone()},a.input_disabled={email:!0,username:!0,displayname:!0,password:!0,timezone:!0},a.pass={password:"",new_password:"",confirm_password:""},a.errors={email:"",username:"",displayname:"",password:"",timezone:"",locale:""},a.updateGeneralInfo=function(b,d){var e={};e[b]=a.current_user[b],a.errors[b]="",console.log(e[b]),"object"==typeof e[b]&&(e[b]=e[b][d]),c.updateGeneralInfo(e,function(c){c.success?a.input_disabled[b]=!0:a.errors[b]=c.errors[0]})},a.changePassword=function(){a.errors.password="",c.updateGeneralInfo({password:a.pass.password,new_password:a.pass.new_password,confirm_password:a.pass.confirm_password},function(b){b.success?a.input_disabled.password=!0:a.errors.password=b.errors[0]})}}]),yamba.App.controller("TrendingController",["$scope","$timeout","$stateParams",function(a,b,c){a.$parent.App.title="Trending",a.trending={filter:{creation_date:c.creation_date}}}]);
//# sourceMappingURL=yamba.min.js.map